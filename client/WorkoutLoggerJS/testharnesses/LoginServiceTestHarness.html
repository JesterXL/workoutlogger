<!DOCTYPE html>
<html>
<head>
    <title>LoginServiceTestHarness</title>
    <script src="../bower_components/requirejs/require.js"></script>
    <script src="requirejs-config.js"><</script>
</head>
<body>

<script>
    require(["com/jessewarden/workoutlogger/services/GetTokenService",
        "com/jessewarden/workoutlogger/services/LoginService",
        "com/jessewarden/workoutlogger/events/EventBus"], function(GetTokenService, LoginService, EventBus)
    {
        tokenService = new GetTokenService();

        function onToken()
        {
            EventBus.on("LoginService:success", function(msg)
            {
                console.log("user:", loginService.user);
            });
            EventBus.on("LoginService:error", function(msg)
            {
                console.error("Login error.");
            });
            loginService = new LoginService();
            loginService.login(tokenService.token, "jessewarden", "jessewarden");
        }

        EventBus.on("GetTokenService:success", function()
        {
            onToken();
        });
        EventBus.on("GetTokenService:error", function()
        {
            console.error("Token error.");
        });



        tokenService.getToken();
    });

</script>
</body>
</html>